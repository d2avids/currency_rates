# Currency Rates
[![Python 3.12](https://badgen.net/badge/python/3.12/green)](https://www.python.org/downloads/release/python-3120/)
[![FastAPI](https://img.shields.io/badge/FastAPI-009485.svg?logo=fastapi&logoColor=white)](https://pypi.org/project/fastapi/)
[![Docker](https://img.shields.io/badge/Docker-2496ED?logo=docker&logoColor=fff)](https://www.docker.com/)
[![Postgres](https://img.shields.io/badge/Postgres-%23316192.svg?logo=postgresql&logoColor=white)](https://www.postgresql.org/)
![coverage](./coverage.svg)
![tests](https://github.com/d2avids/currency_rates/actions/workflows/tests.yml/badge.svg)
![deploy](https://github.com/d2avids/currency_rates/actions/workflows/deploy.yml/badge.svg)
---
## Description

Currency Rates API is a modern, high-performance API built with FastAPI that delivers real-time currency conversion rates for specific dates. The API first attempts to retrieve conversion rates from a local database. If the requested data is not found, it automatically fetches the required information from an external resource.

### Notes & limitations:
- Rate 0.0 is returned if there is no data for a given data and currency pair.
- Conversion rates represent the average rate value for a given date.
- The most recent rate available corresponds to the previous day.

---
## Docs
- #### [Swagger](https://currency-rates.servehttp.com/docs/)
- #### [Redoc](https://currency-rates.servehttp.com/redoc/)

### Request example:
```shell
curl -X 'POST' \
  'https://currency-rates.servehttp.com/v1/currency-rates/get-rate' \
  -H 'accept: application/json' \
  -H 'X-API-Key: <key>' \
  -H 'Content-Type: application/json' \
  -d '{
  "fromCur": "USD",
  "toCur": "EUR",
  "date": "2019-02-01"
}'
```
### Response example:
```shell
{
  "fromCur": "USD",
  "toCur": "EUR",
  "date": "2019-02-01",
  "rate": "0.87161482"
}
```

---
## Tech stack:
- **Python 3.12**
- **FastAPI** - a high-performance web framework for building APIs with autogenerated OpenAPI documentation.
- **PostgreSQL** - an open-source relational database.
- **SQLAlchemy** - a Python ORM and SQL toolkit for interacting with databases using an object-oriented approach.
- **Alembic** - a database migration tool for managing schema changes in SQLAlchemy-based projects.
- **Pydantic** - a data validation and settings management library that ensures type safety in FastAPI applications.
- **Uvicorn** - a fast ASGI server for running FastAPI applications in production.
- **Pytest** - a testing package, used alongside **testcontainers** for containerized database testing.
- **CI/CD** - Continuous Integration and Continuous Delivery via **Github Actions** workflow 
---
## Installation
### 1. Install poetry dependencies:
```shell
poetry install
```

### 2. Activate virtual environment:
```shell
poetry shell
```

### 3. Set environment variables in .env file based on .env_example:

```shell
cp .env_example .env
```

###  4. Run the service locally:

```shell
cd src && python main.py
```

### or in Docker containers:
```shell
docker compose up --build --force-recreate -d
```
---
## Author
- **David Saidov**, *saidov2.david@gmail.com*
